/*! gx-bootstrap 2016-04-21 */
gx.bootstrap={},gx.bootstrap.CheckButton=new Class({gx:"gx.bootstrap.CheckButton",Extends:gx.ui.Container,options:{size:"regular",label:"&nbsp;",value:!1},class_checked:"btn-success",class_unchecked:"btn-warning",_checked:!1,_disabled:!1,_labelActive:!1,_labelInactive:!1,initialize:function(a,b){var c=this;try{this.parent(a,b);var d="btn btn-default"+("regular"==this.options.size?"":" btn-"+this.options.size);this._display.group=new Element("div",{"class":"btn-group"}),this._display.root.adopt(this._display.group),this._display.button=new Element("button",{"class":d}),this._display.indicator=new Element("button",{"class":d}),this._display.group.adopt([this._display.indicator,this._display.button]),this._display.button.addEvent("click",function(a){a.preventDefault(),c.toggle()}),this._display.indicator.addEvent("click",function(a){a.preventDefault(),c.toggle()}),this.setLabel(this.options.label),this.options.value?this.check(1):this.uncheck(1)}catch(e){gx.util.Console("gx.bootstrap.CheckButton->initialize",e.message)}},setLabel:function(a){return"array"==typeOf(a)?(this._labelInactive=a.pop(),void(this._labelActive=a.pop())):(this._labelInactive=a,void(this._labelActive=a))},get:function(){return this._checked},toggle:function(a){return this._checked?this.uncheck(a):this.check(a),!1},check:function(a){this._disabled||(this._display.indicator.removeClass(this.class_unchecked),this._display.indicator.addClass(this.class_checked),this._display.indicator.set("html",'&nbsp;<span class="glyphicon glyphicon-ok"></span>'),this._display.button.set("html",this._labelActive),this._checked=!0,null!=a&&a||(this.fireEvent("change",!0),this.fireEvent("check")))},uncheck:function(a){this._disabled||(this._display.indicator.removeClass(this.class_checked),this._display.indicator.addClass(this.class_unchecked),this._display.indicator.set("html",'&nbsp;<span class="glyphicon glyphicon-remove"></span>'),this._display.button.set("html",this._labelInactive),this._checked=!1,null!=a&&a||(this.fireEvent("change",!1),this.fireEvent("check")))},set:function(a){a?this.check():this.uncheck()},setDisabled:function(a){this._disabled=a,this._display.indicator.disabled=a,this._display.button.disabled=a}}),gx.bootstrap.Checklist=new Class({gx:"gx.bootstrap.Checklist",Extends:gx.ui.Container,options:{height:150,width:350,search:!0,method:"POST",data:!1,url:!1,getItemValue:null,requestData:{},listValue:"value",listFormat:function(a){return a.label},decodeResponse:function(a){return JSON.decode(a)},onClick:!1},_elems:[],_bg:"",initialize:function(a,b){var c=this;try{if(this.parent(a,b),this._display.frame=new Element("div",{styles:{overflow:"auto"}}),this.options.height&&this._display.frame.setStyle("height",this.options.height),this._display.root.addClass("bs-checklist"),this._display.root.setStyle("width",c.options.width),this.options.search){var d=new Element("input",{type:"text","class":"form-control"}).addEvent("keyup",function(a){c.search(a.target.value)});this._display.root.adopt(new Element("div",{"class":"form-group input-group"}).adopt(new Element("span",{"class":"input-group-addon"}).adopt(new Element("i",{"class":"glyphicon glyphicon-search"})),d))}this._display.root.adopt(this._display.frame);var e=new Element("table",{"class":"table table-striped"}).setStyle("margin-bottom","0px");this._display.tbody=new Element("tbody"),this.options.onClick&&e.addEvent("click",this.options.onClick),this._display.frame.adopt(e.adopt(this._display.tbody)),this.options.url&&this.loadFromURL(this.options.url,this.options.requestData),Array.isArray(this.options.data)&&this.set(this.options.data)}catch(f){gx.util.Console("gx.bootstrap.Checklist->initialize",f.message)}},set:function(a){try{if(this._display.tbody.empty(),null==a)return;a.each(function(a){this.addItem(a)},this)}catch(b){gx.util.Console("gx.bootstrap.Checklist->set",b.message)}},addItem:function(a){try{var b={label:null!=this.options.listFormat?this.options.listFormat(a):a,value:null==this.options.getItemValue?a.value:this.options.getItemValue(a),input:new gx.bootstrap.CheckButton};b.row=new Element("tr");var c=new Element("td",{width:90});c.adopt(b.input),b.row.adopt(c);var d=new Element("td",{html:b.label});d.addEvent("click",function(){b.input.toggle()}),b.row.adopt(d),this._display.tbody.adopt(b.row),this._elems.push(b),this._bg=""==this._bg?" bg":""}catch(e){gx.util.Console("gx.bootstrap.Checklist->addItem",e.message)}},search:function(a){try{var b=new RegExp(a);this._elems.each(function(a){-1!=a.value.search(b)?a.row.setStyle("display","table-row"):a.row.setStyle("display","none")},this)}catch(c){gx.util.Console("gx.bootstrap.Checklist->search",c.message)}},reset:function(){try{this._elems.each(function(a){a.input.uncheck()})}catch(a){gx.util.Console("gx.bootstrap.Checklist->reset",a.message)}},setValues:function(a){try{return this._elems.each(function(b){b.input.set(a.contains(b.value))}),a}catch(b){throw gx.util.Console("gx.bootstrap.Checklist->setValues",b.message),b}},getValues:function(a){try{var b=[];return this._elems.each(function(c){c.input.get()&&(null==a?b.push(c.value):null!=c.value[a]&&b.push(c.value[a]))}),b}catch(c){throw gx.util.Console("gx.bootstrap.Checklist->getValues",c.message),c}},loadFromURL:function(a,b,c){var d=this;try{this._elems=[],this._bg="",this._display.tbody.empty(),null==a&&(a=d.options.url),null==b&&(b=d.options.requestData);var e=new Request({method:d.options.method,url:a,data:b,onComplete:function(){d._display.frame.removeClass("loader")},onSuccess:function(a){try{var b=d.options.decodeResponse(a);isArray(b)?(d.set(b),null!=c&&c(b)):gx.util.Console("gx.bootstrap.Checklist->loadFromUrl","Invalid server answer: "+a)}catch(e){gx.util.Console("gx.bootstrap.Checklist->loadFromUrl",e.message)}},onRequest:function(){d._display.frame.addClass("loader")}});e.send()}catch(f){gx.util.Console("gx.bootstrap.Checklist->loadFromUrl",f.message)}}}),gx.bootstrap.DataFilter=new Class({Extends:gx.ui.Container,Binds:["clearFilter"],options:{elementWidth:"30%",notSelected:" ",clearBtn:!0},origin:null,filtered:null,filter:[],_theme:{root:"gxBootstrapDataFilter form-inline"},initialize:function(a,b){this.parent(a,b),this._ui.root.addClass(this._theme.root),this._ui.clear=new Element("div",{style:"clear:both;"}),this._ui.clearBtn=new Element("button",{"class":"btn btn-default",type:"submit",html:'<span class="glyphicon glyphicon-ban-circle"></span>'}),this._ui.clearBtn.addEvent("click",this.clearFilter),this._ui.root.adopt(this.options.clearBtn?this._ui.clearBtn:null,this._ui.clear)},addCustomElement:function(a){return a.inject(this._ui.clear,"before"),this},addSelectFilter:function(a,b,c,d,e){var f=new Element("select",{placeholder:b,"class":"form-control"});d||(d=this.options.elementWidth),e||(e=this.selectFilter);var g={identifier:a,input:f,fields:"array"!=typeOf(c)?[c]:c,method:e,type:"Select"};f.addEvent("change",function(a){g.value=a.target.get("value"),this.doFilter()}.bind(this));var h=new Element("div",{"class":"input-group",styles:{width:d}}).adopt(new Element("div",{"class":"input-group-addon",html:b}),f);return g.section=h,h.inject(this._ui.clear,"before"),this.filter.push(g),this},addFulltextFilter:function(a,b,c,d,e){var f=new Element("input",{placeholder:c,"class":"form-control"});d||(d=this.options.elementWidth),e||(e=this.fulltextFilter);var g={identifier:a,input:f,fields:"array"!=typeOf(b)?[b]:b,method:e,type:"Fulltext"};f.addEvent("keyup",function(a){g.value=a.target.get("value"),this.doFilter()}.bind(this));var h=new Element("div",{"class":"input-group",styles:{width:d}});return c?h.adopt(new Element("div",{"class":"input-group-addon",html:c}),f):h.adopt(f,new Element("div",{"class":"input-group-addon",html:'<span class="glyphicon glyphicon-search"></span>'})),g.section=h,h.inject(this._ui.clear,"before"),this.filter.push(g),this},clearFilter:function(){this.filter.each(function(a){"Select"==a.type?a.input.selectedIndex=0:"Fulltext"==a.type&&a.input.set("value",""),a.value=null}.bind(this)),this.doFilter()},initData:function(a){return this.origin=a,this.filter.each(function(a){var b="init"+a.type+"Filter";this[b](a)}.bind(this)),this},initSelectFilter:function(a){var b=a.input.selectedIndex,c={};this.origin.each(function(b,d){for(var e=0;e<a.fields.length;e++){var f,g=a.fields[e];g="function"==typeOf(g)?g(b):b[g],"object"==typeOf(g)?(f=g.label,g=g.field):f=g,null==c[g]&&(c[g]=f)}});var d=[];d.push(new Element("option",{html:this.options.notSelected,value:"",selected:"selected"})),Object.each(c,function(a,b){d.push(new Element("option",{html:a,value:b}))}),a.input.empty().adopt(d),a.input.selectedIndex=b},initFulltextFilter:function(a){},doFilter:function(){var a=this;return this.filtered=Array.clone(this.origin),this.filter.each(function(b){null!=b.value&&""!=b.value&&(a.filtered=a.filtered.filter(function(a,c){for(var d=!1,e=0;e<b.fields.length;e++){var f=b.fields[e];if(f="function"==typeOf(f)?f(a):a[f],"object"==typeOf(f)&&(f=f.field),d=b.method(b.value,f))break}return d}))}),this.fireEvent("filtered",[this.filtered]),this.filtered},fulltextFilter:function(a,b){return new RegExp(".*"+a+".*","i").test(b)},selectFilter:function(a,b){return a==b},getFilter:function(a){for(var b=0;b<this.filter.length;b++)if(this.filter[b].identifier==a)return this.filter[b];return null}}),gx.bootstrap.Field=new Class({gx:"gx.bootstrap.Field",Extends:gx.ui.Container,options:{label:"",type:"text",description:"",highlight:!1,"default":null,horizontal:["col-md-3","col-md-9"],hintpos:"right",highlighteffect:!1},_display:{},initialize:function(a){try{this.parent(new Element("div",{"class":"form-group"}),a),this._display.label=new Element("label",{"class":"control-label","for":"",html:this.options.label}),this.options.horizontal!==!1&&this._display.label.addClass(this.options.horizontal[0]),this._display.hint=this._display.label,this._display.highlight=new Element("span",{"class":"help-block highlight"}),this._display.description=new Element("span",{"class":"help-block",html:this.options.description}),this._display.root.adopt(this._display.label),this._display.controlwrapper=new Element("div"),this.setField(this.options.type,a),this._display.hint.addClass("hint--fwidth hint--"+this.options.hintpos),this._display.controlwrapper.adopt(this._display.description,this._display.highlight)}catch(b){gx.util.Console("gx.bootstrap.Field->initialize",b.stack)}},setLabel:function(a){this._display.label.set("html",a)},setHelp:function(a){this._display.description.setProperty("html",a)},setField:function(a,b){if(null==this._display.field){var c,d=this;switch(typeOf(a)){case"element":this._display.field=a,this._type="element",c=a;break;case"string":switch(this._type=a,a){case"text":case"password":case"file":case"checkbox":case"string":case"integer":case"float":var e=a;("float"==a||"string"==a||"integer"==a)&&(e="text"),this._display.field=new Element("input",{type:e}),null!=b.disabled&&this._display.field.set("disabled",!0),null!=b["default"]&&this._display.field.set("value",b["default"]),b.checked&&(this._display.field.checked=b.checked),c=this._display.field,"integer"==a?c.addEvent("blur",function(){/^\d*$/.test(this.get("value"))?d.setHighlight():d.setHighlight("This field must be an integer!","error")}):"float"==a&&c.addEvent("blur",function(){/^(\d+((\.|\,)\d+)?)*$/.test(this.get("value"))?d.setHighlight():d.setHighlight("This field must be a floating point!","error")});break;case"textarea":this._display.field=new Element("textarea"),null!=b["default"]&&this._display.field.setProperty("html",b["default"]),c=this._display.field;break;case"select":switch(this._display.field=new Element("select"),typeOf(b.options)){case"array":b.options.each(function(a){var c=new Element("option",{value:a,text:a});null!=b["default"]&&b["default"]==a&&c.setProperty("selected","selected"),this._display.field.adopt(c)}.bind(this));break;case"object":var f;for(var g in b.options)f=new Element("option",{html:b.options[g],value:g}),null!=b["default"]&&b["default"]==g&&f.setProperty("selected","selected"),this._display.field.adopt(f)}c=this._display.field;break;case"optionlist":this._display.field=new Element("div");var h=null==b["default"]?null:b["default"];switch(typeOf(b.options)){case"array":b.options.each(function(a){this._display.field.adopt(__({children:[{tag:"input",name:b.id,type:"radio",id:"radiobtn",value:a,checked:a==h}," "+a]}))}.bind(this));break;case"object":for(g in b.options)this._display.field.adopt(__({children:[{tag:"input",name:b.id,type:"radio",id:"radiobtn",value:g,checked:g==h}," "+b.options[g]]}))}c=this._display.field;break;case"checklist":this._display.field=new gx.bootstrap.Checklist(null,null==b.options?b:b.options),c=$(this._display.field),this._type="gx";break;case"date":b.orientation="right",delete b.label,this._display.field=new gx.bootstrap.DatePicker(null,null==b.options?b:b.options),c=$(this._display.field),this._type="gx";break;case"month":this._display.field=new gx.bootstrap.MonthPicker(null,null==b.options?b:b.options),c=$(this._display.field),this._type="gx";break;case"time":this._display.field=new gx.bootstrap.Timebox(null,null==b.options?b:b.options),c=$(this._display.field),this._type="gx";break;case"gxselect":delete b.label,this._display.field=new gx.bootstrap.Select(null,b),c=$(this._display.field),this._type="gx";break;case"multivalueeditor":this._display.field=new gx.bootstrap.MultiValueEditor(null,null==b.options?b:b.options),c=$(this._display.field),this._type="gx";break;case"editor":this._display.field=new gx.bootstrap.Editor(null,null==b.options?b:b.options),c=$(this._display.field),this._type="gx";break;case"html":c=null==b.content?new Element("div"):b.content}break;case"class":a=null!=b.options?new a(null,b.options):new a(null,b);case"object":instanceOf(a,gx.ui.Container)&&"function"==typeOf(a.display)&&(this._display.field=a,this._type="gx",c=$(a)),null!=this.options.value&&this.setValue(this.options.value);break;default:return}var i=c.get("tag");("textarea"==i||"select"==i||"input"==i)&&c.addClass("form-control"),void 0!=b&&void 0!=b.disabled&&this.setDisabled(b.disabled),c=this._display.controlwrapper.adopt(c),this.options.horizontal!==!1&&(this._display.hint=this._display.controlwrapper,this._display.controlwrapper.addClass(this.options.horizontal[1])),c.inject(this._display.root)}},getValue:function(){switch(this._type){case"element":case"text":case"password":case"file":case"select":case"textarea":case"string":case"integer":case"float":return this._display.field.get("value");case"optionlist":var a;return this._display.field.getElements("input").each(function(b){b.checked&&(a=b.get("value"))}),a;case"checkbox":return this._display.field.get("checked");case"multivalueeditor":return this._display.field.getValue();case"object":case"gx":case"editor":if("function"==typeOf(this._display.field.getValue))return this._display.field.getValue();if("function"==typeOf(this._display.field.getValues))return this._display.field.getValues();if("function"==typeOf(this._display.field.get))return this._display.field.get();default:return null}},setDisabled:function(a){switch(this._type){case"element":case"text":case"password":case"file":case"select":case"textarea":case"checkbox":case"multivalueeditor":this._display.field.disabled=a;break;case"optionlist":;this._display.field.getElements("input").each(function(b){b.disabled=a});break;case"object":case"gx":"boolean"==typeOf(this._display.field.disabled)&&(this._display.field.disabled=a),"function"==typeOf(this._display.field.setDisabled)&&this._display.field.setDisabled(a)}return this},setHighlight:function(a,b){this._display.root.removeClass("has-error"),this._display.root.removeClass("has-success"),this._display.root.removeClass("has-warning");var c=this;if(null==a||a===!1||""==a?this.options.highlighteffect?function(){c._display.highlight.removeClass("visible")}.delay(200):c._display.highlight.removeClass("visible"):(this._display.highlight.set("html",a),this._display.highlight.addClass("visible")),null!=b)switch(b){case"error":case"success":case"warning":this.options.highlighteffect?function(){c._display.root.addClass("has-"+b)}.delay(10):c._display.root.addClass("has-"+b)}return this},setHintHighlight:function(a,b){this._display.root.removeClass("has-error"),this._display.root.removeClass("has-success"),this._display.root.removeClass("has-warning");var c=this._display.hint;return c.removeClass("hint--always"),c.removeClass("hint--error"),c.removeClass("hint--success"),c.removeClass("hint--warning"),null==a||""==a?void(this.options.highlighteffect?function(){c.erase("data-hint")}.delay(200):c.erase("data-hint")):(c.addClass("hint--"+b),this._display.root.addClass("has-"+b),c.set("data-hint",a),this.options.highlighteffect?function(){c.addClass("hint--always")}.delay(1):c.addClass("hint--always"),this)},setValue:function(a){switch(this._type){case"text":case"password":case"textarea":this._display.field.set("value",a);break;case"select":var b,c=this._display.field.options;for(b=0;b<c.length;b++)if(a==c[b].get("value")){c[b].selected=!0;break}break;case"checkbox":this._display.field.checked=a?!0:!1;break;case"optionlist":this._display.field.getElements("input").each(function(b){b.get("value")==a?b.set("checked",!0):b.erase("checked")});break;case"gx":case"editor":"function"==typeOf(this._display.field.setValue)?this._display.field.setValue(a):"function"==typeOf(this._display.field.setValues)?this._display.field.setValues(a):"function"==typeOf(this._display.field.set)&&this._display.field.set(a);break;default:if(null!=this._display.field&&null!=this._display.field.get)switch(this._display.field.get("tag")){case"input":case"select":this._display.field.set("value",a)}}return this.fireEvent("setValue",[a]),this},reset:function(){"function"==typeOf(this._display.field.reset)?this._display.field.reset():null!=this.options["default"]?this.setValue(this.options["default"]):this.setValue()},getInput:function(){return this._display.field},focus:function(){("function"==typeOf(this._display.field.focus)||"element"==typeOf(this._display.field))&&this._display.field.focus()}}),gx.bootstrap.FieldUpload=new Class({Extends:gx.bootstrap.Field,options:{position:"regular",height:60,width:60,inputname:"upload",uploadurl:"./index.php",params:{},imageurl:"",placeholder:null,finishdelay:2e3,disabledMessage:"Disabled",hintpos:"bottom",showError:function(a,b){a.error(b),console.log("gx.bootstrap.FieldImgUpload: Upload error",b)},parseResponse:function(a,b,c){var d;try{d=JSON.decode(b)}catch(e){return void a.options.showError(a,"Could not parse server response: "+b)}null!=d.error?a.options.showError(a,d.error):c(d.result)}},running:!1,disabled:!1,initialize:function(a){null==a.type&&(a.type=new Element("div")),this.parent(a),this.create()},create:function(){this._ui.root.addClass("gxBootsrapImgUpload "+this.options.position),this._display.controlwrapper.adopt(this.options.type);var a=this;this._ui.select=__({tag:"input",type:"file",title:"Drop File or Click",styles:{height:this.options.height,width:this.options.width},onChange:function(){a.processFiles(this.files)},onClick:function(){return a.running?!1:a.disabled?(a.displayDisabled(),!1):!0}}),this._ui.progressText=new Element("span",{"class":"",html:"40 / 100"}),this._ui.progressAbort=new Element("span",{"class":"glyphicon glyphicon-remove",events:{click:this.abort.bind(this)}}),this._ui.progress=new Element("div",{"class":"progress-bar",style:"width: 40%;"}),this._ui.image=new Element("div",{"class":"image",styles:{height:this.options.height,width:this.options.width}}),this._ui.placeholder=new Element("img",{"class":"placeholder",src:""}),this._ui.image.adopt(this._ui.placeholder,new Element("div.textprogress").adopt(new Element("div.blend"),this._ui.progressText,this._ui.progressAbort,new Element("div.progress").adopt(this._ui.progress)),this._ui.select),this.options.placeholder&&this._ui.placeholder.setStyle("background-image","url("+this.options.placeholder+")"),this.injectImageArea(this._ui.image),this.initDrop(this._ui.image),this.options["default"]&&this.setValue(this.options["default"])},injectImageArea:function(a){return"regular"==this.options.position||"small"==this.options.position?void a.inject(this._display.field):void new Element("div",{styles:{clear:"both"}}).adopt(new Element("div",{styles:{position:"absolute",left:"0px"}}).adopt(a)).inject(this._display.root)},initDrop:function(a){var b=this;a.ondragover=function(){return b.running?!1:b.disabled?(b.displayDisabled(),!1):(a.addClass("access"),!1)},a.ondragenter=function(){return b.running?!1:b.disabled?(b.displayDisabled(),!1):(a.addClass("access"),!1)},a.ondragleave=function(){return b.running?!1:b.disabled?(b.displayDisabled(),!1):(a.removeClass("access"),!1)},a.ondragend=function(){return b.running?!1:b.disabled?(b.displayDisabled(),!1):(a.removeClass("access"),!1)},a.ondrop=function(c){return b.running?!1:b.disabled?(b.displayDisabled(),!1):(c.stopPropagation(),c.preventDefault(),void(b.running||(a.removeClass("access"),b.processFiles(c.dataTransfer.files))))}},processFiles:function(a){var b=new FormData;this.setActive();var c=a[0];b.append(this.options.inputname,c);for(var d in this.options.params)this.options.params.hasOwnProperty(d)&&b.append(d,this.options.params[d]);var e=this;this.xhr=new XMLHttpRequest,this.xhr.open("POST",this.options.uploadurl),this.xhr.onload=function(){return 200!=this.status?void e.options.showError(e,"Invalid load status: "+this.status):(e.progress(100),void e.options.parseResponse(e,this.responseText,function(a){e.setImage(a),e.finish()}))},this.xhr.onerror=function(a){e.options.showError(e,"Error: "+res.error)},this.xhr.upload.onprogress=function(a){if(a.lengthComputable){var b=a.loaded/a.total*100|0;e.progress(b)}},this.xhr.send(b)},setActive:function(){this.running=!0,this.setHighlight(),this._ui.progress.removeClass("progress-bar-success"),this._ui.progress.removeClass("progress-bar-danger"),this._ui.progress.removeClass("progress-bar-warning"),this._ui.progress.setStyle("width","0%"),this._ui.image.addClass("active"),this._ui.progressAbort.show()},abort:function(){this.xhr&&this.xhr.abort(),this._ui.progressAbort.hide(),this.setHighlight("","warning"),this._ui.progress.addClass("progress-bar-warning"),function(){this.setHighlight(),this._ui.progress.removeClass("progress-bar-warning"),this._ui.image.removeClass("active")}.bind(this).delay(this.options.finishdelay),this._ui.select.erase("value"),this.running=!1},error:function(a){this.setHighlight(a,"error"),this._ui.progress.addClass("progress-bar-danger"),this._ui.progressAbort.hide(),this._ui.select.erase("value"),this.running=!1},finish:function(){this.setHighlight("","success"),this._ui.progress.addClass("progress-bar-success"),this._ui.progressAbort.hide(),function(){this.setHighlight(),this._ui.progress.removeClass("progress-bar-success"),this._ui.image.removeClass("active")}.bind(this).delay(this.options.finishdelay),this._ui.select.erase("value"),this.running=!1},progress:function(a){this._ui.progress.setStyle("width",a+"%"),this._ui.progressText.set("html",a+"%")},setValue:function(a){this.setImage(a)},getValue:function(){return null},setImage:function(a){this._ui.placeholder.set("src",this.options.imageurl+a)},reset:function(){},setDisabled:function(a){this.disabled=a,this.disabled?this._ui.root.addClass("disabled"):this._ui.root.removeClass("disabled")},displayDisabled:function(){this.setHighlight(this.options.disabledMessage,"warning"),function(){this.setHighlight()}.delay(2e3,this)}}),gx.bootstrap.Fieldset=new Class({gx:"gx.bootstrap.Fieldset",Extends:gx.ui.Container,options:{size:"regular",title:null,value:!1,horizontal:["col-md-3","col-md-9"],columns:!1,hintpos:"right",highlighteffect:!0},_theme:{horizontal:"form-horizontal",columns:"form-columns"},_fields:{},_currentcolumn:0,initialize:function(a,b){try{this.parent(null==a?new Element("fieldset"):a,b),this.options.horizontal!==!1&&this._ui.root.addClass(this._theme.horizontal),null!=this.options.title&&this._ui.root.adopt(new Element("legend",{html:this.options.title})),this.initColumns(this.options.columns),this._ui.root.addClass(this._theme.columns),"object"==typeOf(this.options.fields)&&this.addFields(this.options.fields)}catch(c){gx.util.Console("gx.bootstrap.Fieldset->initialize",c.stack)}},initColumns:function(a){"number"!=typeof a&&(a=1),this._ui.columns=[];for(var b=0;a>b;b++){var c=new Element("div",{"class":"column",styles:{"float":"left",width:100/a+"%"}});this._ui.columns.push(c),this._ui.root.adopt(c)}this.options.columns=a},clear:function(){for(var a in this._fields)this._fields.hasOwnProperty(a)&&this._fields[a]instanceof gx.bootstrap.Field&&$(this._fields[a]).destroy(),delete this._fields[a];this._fields={}},hasField:function(a){return void 0!==this._fields[a]},addFields:function(a){for(id in a)a[id]instanceof Element||a[id]instanceof gx.ui.Container?this.addFieldItem(id,a[id]):"object"==typeOf(a[id])&&instanceOf(a[id],gx.bootstrap.Field)?this.addFieldItem(id,a[id]):null!=a[id].type?this.addField(id,a[id].type,a[id]):null!=a[id].field&&this.addField(id,a[id].field,a[id])},addFieldItem:function(a,b){if(this.hasField(a))throw new Error('Field "'+a+'" already exists.');return this._fields[a]=b,this._ui.columns[this._currentcolumn].adopt($(b)),this.nextColumn(),b},nextColumn:function(){1!=this.options.columns&&(this._currentcolumn++,this._currentcolumn==this.options.columns&&(this._currentcolumn=0))},addField:function(a,b,c){return null==c&&(c={}),null==c.horizontal&&(c.horizontal=this.options.horizontal),null==c.hintpos&&(c.hintpos=this.options.hintpos),null==c.highlighteffect&&(c.highlighteffect=this.options.highlighteffect),this.addFieldItem(a,new gx.bootstrap.Field(Object.merge(c||{},{id:a,type:b})))},getValue:function(a){return null==this._fields[a]||void 0==this._fields[a].getValue?null:this._fields[a].getValue()},getValues:function(){var a={};for(id in this._fields)"__"!=String(id).substr(0,2)&&(a[id]=this.getValue(id));return a},reset:function(){for(id in this._fields)null!=this._fields[id].reset&&this._fields[id].reset()},focus:function(a){null!=this._fields[a]&&this._fields[a].focus()},getField:function(a){return this._fields[a]},getFields:function(){return this._fields},setValue:function(a,b){null!=this._fields[a]&&this._fields[a].setValue(b)},setValues:function(a){for(fieldid in a)this.setValue(fieldid,a[fieldid])},setHighlights:function(a,b){null==a&&(a={});var c=0;for(id in this._fields)if(null!=this._fields[id].setHighlight)switch(typeOf(a[id])){case"string":case"boolean":this._fields[id].setHighlight(a[id],b),c++;break;case"object":this._fields[id].setHighlight(a[id].label,a[id].type),c++;break;default:this._fields[id].setHighlight()}return c},setHintHighlights:function(a,b){null==a&&(a={});var c=0;for(id in this._fields)if(null!=this._fields[id].setHintHighlight)switch(typeOf(a[id])){case"string":case"boolean":this._fields[id].setHintHighlight(a[id],b),c++;break;case"object":this._fields[id].setHintHighlight(a[id].label,a[id].type),c++;break;default:this._fields[id].setHintHighlight()}return c}}),gx.bootstrap.Form=new Class({gx:"gx.bootstrap.Form",Extends:gx.ui.Container,options:{size:"regular",label:"",value:!1,horizontal:["col-md-3","col-md-9"],columns:!1,hintpos:"right",highlighteffect:!0},_fieldsets:[],initialize:function(a,b){try{this.parent(null==a?new Element("form"):a,b),"object"==typeOf(this.options.fields)&&this.addFieldset({fields:this.options.fields,title:this.options.title}),null!=this.options.actions&&this.addActions(this.options.actions)}catch(c){gx.util.Console("gx.bootstrap.Form->initialize",c.message)}},addActions:function(a){switch(null==this._ui.actions&&(this._ui.actions=new Element("div",{"class":"form-actions"}),this._ui.actions.adopt(new Element("div.clear")),this._ui.root.adopt(this._ui.actions)),typeOf(a)){case"array":a.each(function(a){__(a).inject(this._ui.actions,"top")}.bind(this));break;case"element":a.inject(this._ui.actions,"top");break;default:__(a).inject(this._ui.actions,"top")}},addFieldset:function(a){return null==a.horizontal&&(a.horizontal=this.options.horizontal),null==a.columns&&(a.columns=this.options.columns),null==a.hintpos&&(a.hintpos=this.options.hintpos),null==a.highlighteffect&&(a.highlighteffect=this.options.highlighteffect),"object"==typeOf(a)&&(instanceOf(a,gx.bootstrap.Fieldset)||(a=new gx.bootstrap.Fieldset(null,a))),this._fieldsets.push(a),null==this._ui.actions?this._ui.root.adopt($(a)):$(a).inject(this._ui.actions,"before"),a},getValue:function(a){for(var b,c=0,d=this._fieldsets.length;d>c;c++)if(b=this._fieldsets[c].getValue(a),null!=b)return b;return null},getValues:function(){var a={};return this._fieldsets.each(function(b){a=Object.merge(a,b.getValues())}),a},getField:function(a){var b;return this._fieldsets.each(function(c){b||(b=c.getField(a))}),b},getFieldsets:function(){return this._fieldsets},setValue:function(a,b){this._fieldsets.each(function(c){null!=c.getField(a)&&c.setValue(a,b)})},setValues:function(a){this._fieldsets.each(function(b){b.setValues(a)})},setHighlights:function(a,b){var c=0;return this._fieldsets.each(function(d){c+=d.setHighlights(a,b)}),c},setHintHighlights:function(a,b){var c=0;return this._fieldsets.each(function(d){c+=d.setHintHighlights(a,b)}),c},reset:function(){this._fieldsets.each(function(a){a.reset(),a.setHighlights(),a.setHintHighlights()})}}),gx.bootstrap.Grid=new Class({Extends:gx.core.Settings,AT_ROOT:1,AT_ROW:2,AT_CELL:3,options:{classes:["md"],rowLength:12,automatedRows:!0,nested:!1},parentGrid:null,initialize:function(a,b,c){this.parentGrid=c,"string"==typeof b&&(b={classes:[b]}),this.parent(b),"string"==typeof this.options.classes&&(this.options.classes=[this.options.classes]),this.parseClasses(this.options.classes),a||(a=new Element("div")),this.options.nested!==!0&&a.addClass("container-fluid"),this.root=a,this.isAt=this.AT_ROOT,this.current=this.root,this.options.rowLength=parseInt(this.options.rowLength),this.rowLength=this.options.rowLength},toParent:function(){return this.parentGrid},grid:function(a,b){"string"==typeof b&&(b={classes:[b]});var c=new gx.bootstrap.Grid(a,Object.merge({},this.options,{nested:!0},b||{}),this);return this.current.adopt(c),c},row:function(){var a=this.current;return this.isAt===this.AT_CELL?a=this.root:this.isAt===this.AT_ROW&&(a=a.getParent()),this.current=new Element("div.row"),this.isAt=this.AT_ROW,this.rowLength=0,a.adopt(this.current),this},currentRow:function(){return this.isAt===this.AT_CELL?this.current.getParent():this.isAt===this.AT_ROW?this.current:this.row()},parseCellClassesFromPrimitive:function(a){if("number"==typeof a)return[a];var b=String(a).split(":"),c=b[0],d=b[1];if(!d)return[c];var e=parseInt(c);return Number.isNaN(e)?[parseInt(d),c]:[e,d]},cell:function(){var a,b,c,d,e=new Element("div"),f=[],g=[];if(arguments.length>0)for(c=0,d=arguments.length;d>c;c++)a=arguments[c],b=typeof a,"number"===b?f.push([a]):"string"===b?f.push(this.parseCellClassesFromPrimitive(a)):g.push(a);g.length>0&&e.adopt(g),0===f.length&&f.push([this.options.rowLength-this.rowLength]);var h;for(c=0,d=f.length;d>c;c++)h=f[c],this.applyClasses(h[0],e,h[1]?this.parseClasses(h[1]):null);h=f[0],this.options.automatedRows&&this.rowLength>=this.options.rowLength&&this.row();var i=this.current;return this.isAt===this.AT_CELL?i=i.getParent():this.isAt===this.AT_ROOT&&(i=this.row()),this.isAt=this.AT_CELL,this.rowLength+=parseInt(h),this.current=e,i.adopt(this.current),this},toElement:function(){return this.root},applyClasses:function(a,b,c){var d=0;c=c||this.options.classes;for(var e=c.length;e>d;d++)b.addClass(c[d]+a)},parseClasses:function(a){return"string"==typeof a?["col-"+a+"-"]:(a.forEach(function(b,c){a[c]="col-"+b+"-"}),a)}}),function(){"use strict";var a=Array.prototype.slice,b=gx.ui.Templates;b.register("icon",function(b,c){return b("span",".=glyphicon glyphicon-"+c,a.call(arguments,2))}),b.register("button",function(b,c){return"string"==typeof c&&(c={type:c}),b(c.tag||"button",c.label||"",".=btn btn-"+(c.type||"primary")+" "+(c.className||""),c.ref?":="+c.ref:null,a.call(arguments,2));
}),b.register("panel",function(b,c){var d=null;return c.head&&(d=b("div",".=panel-heading",b("h3",".=panel-title",c.head))),b("div",".=panel panel-"+(c.type||"default"),d,b("div",".=panel-body",c.body||a.call(arguments,2)))}),b.register("formGroup",function(b,c){var d=c.ref||"",e=b("label",".=control-label",{"for":d});c.label===!1?e=null:c.label?e.appendText(String(c.label).htmlSpecialChars()):c.labelHtml&&e.set("html",c.labelHtml),c.fullEmptyLabel&&e.set("html","&nbsp;").setStyle("width","100%");var f="input";"textarea"===c.type?f="textarea":"select"===c.type&&(f="select");var g;if(c.controlElement){c.controlElement;g=$(c.controlElement)}else g=b(f,d?":=inputField_"+d:null,".=form-control",{value:c.value||"",type:c.type||"text",placeholder:c.placeholder||""});if(c.name&&g.set("name",c.name),c.id&&g.set("name",c.id),c["class"]&&g.addClass(c["class"]),"select"===f)for(var h in c.options)c.options.hasOwnProperty(h)&&g.adopt(b("option",c.options[h],{value:h}));return b("div",".=form-group",e,g,a.call(arguments,2))})}(),gx.bootstrap.MenuButton=new Class({gx:"gx.bootstrap.MenuButton",Extends:gx.ui.Container,options:{size:"regular",style:"",label:"",entries:[],orientation:"left",direction:"down"},class_checked:"btn-success",class_unchecked:"btn-warning",_checked:!1,_style:!1,initialize:function(a,b){var c=this;try{this.parent(a,b);var d="dropdown-toggle btn"+("regular"==this.options.size?"":" btn-"+this.options.size);this._display.frame=new Element("div",{"class":"btn-group"}),this._display.button=new Element("button",{"class":d}),this._display.menu=new Element("ul",{"class":"dropdown-menu"}),"up"==this.options.direction&&this._display.frame.addClass("dropup"),"right"==this.options.orientation&&this._display.menu.addClass("pull-right"),this._display.frame.adopt([this._display.button,this._display.menu]),this._display.root.adopt(this._display.frame),this.options.style&&this.setStyle(this.options.style),this.options.label&&this.setLabel(this.options.label),"array"==typeOf(this.options.entries)&&this.options.entries.each(function(a){c.add(a)}),this.setLabel(this.options.label)}catch(e){gx.util.Console("gx.bootstrap.MenuButton->initialize",e.message)}},add:function(a,b){if(a){var c=new Element("a",{html:(null==b?"":'<i class="icon-'+b+'"></i>')+a});return this._display.menu.adopt(new Element("li").adopt(c)),c}this._display.menu.adopt(new Element("li",{"class":"divider"}))},toggle:function(){this._display.frame.toggleClass("open")},open:function(){this._display.frame.addClass("open")},close:function(){this._display.frame.removeClass("open")},setLabel:function(a){this._display.button.set("html",a+'&nbsp;&nbsp;<span class="caret"></span>')},setStyle:function(a){this._style&&this._display.button.removeClass("btn-"+this_style),this._display.button.addClass("btn-"+a),this._style=a}}),gx.bootstrap.Message=new Class({Extends:gx.ui.Hud,options:{messageWidth:300,opacity:.9,duration:3e3,blend:!1,fixed:!0,"z-index":120,margintop:"50px",x:"center",y:"top"},initialize:function(a,b){var c=this;this.parent(a,b),this._messages=new Array,this._display.windows=new Element("div",{"class":"gx-bootstrap-message",styles:{width:c.options.messageWidth,"margin-top":this.options.margintop,position:"absolute","z-index":c.options["z-index"]+1}}),this.add("messages",this._display.windows,{x:c.options.x,y:c.options.y},c.options.fixed),this.show("messages")},addMessage:function(a,b,c,d,e){var f=this,g=new Element("div",{"class":"bs-message alert alert-"+(null==b?"info":b),styles:{position:"static",opacity:0,"z-index":f.options["z-index"]+2}});if(0!=c){var h=new Element("x",{"class":"close",html:"×"});g.adopt(h),h.addEvent("click",function(){f.closeMessage(g)})}switch(typeOf(a)){case"element":case"elements":case"textnode":g.adopt(a);break;case"object":g.adopt(__(a));break;case"string":case"number":var i="info";switch(b){case"error":i="warning";break;case"success":i="check"}g.adopt(new Element("div",{"class":"bs-message-inner fico-"+i,html:a}))}this._display.windows.adopt(g);var j=new Fx.Morph(g,{duration:"short"});return 1==d&&this.showBlend(),j.start({opacity:f.options.opacity}),this._messages.push(g),f.options.duration>0&&e!==!1&&f.closeMessage.delay(f.options.duration,this,g),g},closeMessage:function(a){var b=this,c=new Fx.Morph(a,{onComplete:function(){b._messages.erase(a),a.destroy(),b._messages.length<1&&b.hideBlend()}});a.setStyle("overflow","hidden"),c.start({opacity:0,height:0})},clear:function(){var a=this;this._messages.each(function(b){a.closeMessage(b)}),this._messages=[],this.hideBlend()},showStatus:function(a,b,c){if(null==this._display.status){var d=new Element("div",{"class":"gx-bootstrap-message-status"});this._display.status=this.addMessage(d,null,!1,c,!1),this._statusbar=new gx.com.Statusbar(d,{message:b,progress:a})}else this.incProgress(a,b)},hideStatus:function(){null!=this._display.status&&(this.closeMessage(this._display.status),this._display.status=null,this._statusbar=null)},incProgress:function(a,b){null!=this._statusbar&&this._statusbar.incProgress(a,b)},setProgress:function(a,b,c){null!=this._statusbar&&this._statusbar.setProgress(a,b,c)}}),gx.bootstrap.MultiValueEditor=new Class({Extends:gx.ui.Container,options:{width:"296px",options:!1,"default":!1},initialized:!1,initialize:function(a,b){try{this.parent(a,b),this._display.root.setStyles({border:"1px #d4d4d4 solid","border-radius":"4px 4px 4px 4px","box-shadow":"0 1px 4px rgba(0, 0, 0, 0.067)"}),this.options["default"]&&(this.options.options=JSON.decode(this.options["default"])),this.options.width&&this._display.root.setStyle("width",this.options.width),this._display.txtAdd=new Element("input",{type:"text"}).setStyles({"margin-bottom":"0px",padding:"0px 6px 0px 6px"}),this._display.btnAdd=new Element("img",{src:"./assets/img/icons/plus2.png"}).setStyles({"vertical-align":"center","margin-left":"7px"}),this._display.btnAdd.txt=this._display.txtAdd,this._display.btnAdd.root=this,this._display.btnAdd.addEvent("click",function(){var a=this.txt;""!=a.value&&("array"!=typeOf(this.root.options.options)&&(this.root.options.options=new Array),this.root.options.options.push(a.value),this.root.refreshOptions(),a.value="")}),this._display.head=new Element("div").setStyles({"border-bottom":"1px #d4d4d4 solid",padding:"6px"}).adopt(this._display.txtAdd).adopt(this._display.btnAdd),this._display.root.adopt(this._display.head),this.options.options&&this.refreshOptions()}catch(c){gx.util.Console("gx.bootstrap.MultiValueEditor->initialize",gx.util.parseError(c))}},move:function(a,b){this.options.options&&(this.options.options.move(a,b),this.refreshOptions())},refreshOptions:function(){this.initialized||(this._display.optionsbox=new Element("div").setStyles({padding:"4px"}),this._display.optionstable=new Element("table",{cellpadding:"3px",cellspacing:"2px"})),this._display.optionstable.empty();for(var a=0;a<this.options.options.length;a++){var b=this.options.options[a],c=new Element("tr"),d=new Element("input",{type:"text",value:b}).setStyles({"margin-bottom":"0px",padding:"0px 6px 0px 6px"}),e=new Element("td").adopt(d);c.adopt(e);var f=new Element("td",{html:'<img src="./assets/img/icons/minus.png" />'}).addEvent("click",function(){});c.adopt(f);var g=new Element("td"),h=new Element("span",{html:"&#9650;"}).addClass("cursorHand").setStyle("margin-right","5px");h.mve=this,h.pos=a,h.addEvent("click",function(){this.mve.move(this.pos,this.pos-1),this.mve.refreshOptions()});var i=new Element("span",{html:"&#9660;"}).addClass("cursorHand");i.mve=this,i.pos=a,i.addEvent("click",function(){this.mve.move(this.pos,this.pos+1),this.mve.refreshOptions()}),0!=a&&g.adopt(h),a!=this.options.options.length-1&&g.adopt(i),c.adopt(g),this._display.optionstable.adopt(c)}this._display.optionsbox.adopt(this._display.optionstable),this.initialized||(this._display.root.adopt(this._display.optionsbox),this.initialized=!0)},getValue:function(){return JSON.encode(this.options.options)},setValue:function(a){return console.log("v",a),this.options.options=JSON.decode(a),this.refreshOptions(),this}}),gx.bootstrap.NavigationBar=new Class({gx:"gx.bootstrap.Tabbox",Extends:gx.ui.Tabbox,options:{},_tabs:{},_buttons:{},build:function(){try{this._display.root.addClass("tabbable"),this._display=Object.merge({},this._display,{navbar:new Element("div",{"class":"navbar"}),navbarinner:new Element("div",{"class":"navbar-inner"}),title:new Element("div",{"class":"brand"}),tablist:new Element("ul",{"class":"nav"}),content:new Element("div",{"class":"tab-content",styles:{overflow:"auto"}}),buttons:new Element("div",{style:"float: right"})}),this.options.height&&this._display.content.setStyle("height",this.options.height),this._display.navbarinner.adopt(this._display.title,this._display.tablist,this._display.buttons),this._display.navbar.adopt(this._display.navbarinner),this._display.root.adopt(this._display.navbar,this._display.content)}catch(a){gx.util.Console("gx.bootstrap.NavigationBar->build",a.message)}return this._display.root},setTitle:function(a){switch(typeOf(a)){case"element":return this._display.title.empty(),this._display.title.adopt(a);case"string":return this._display.title.set("html",a);default:return this._display.title.set(a)}},setTabTitle:function(a,b){this._tabs[a].getFirst("a").set({html:b})},setNavigationButtons:function(a){this._display.buttons.empty(),this._display.buttons.adopt(a)},buildTab:function(a,b){var c=this,d=new Element("a",{html:b.replace(/ /g,"&nbsp;")}),e=new Element("li");return e.adopt(d),this._display.tablist.adopt(e),d.addEvent("click",function(){c.openTab(a)}),this._tabs[a]=e,e},buildContent:function(a){var b=new Element("div",{"class":"tab-pane"}).adopt(a);return this._display.content.adopt(b),b},setHighlight:function(a,b,c){if(null!=this._tabs[a]){var d=this._tabs[a].getElement("span");null!=d&&d.destroy(),null==c&&(c="important"),null!=b&&(d=new Element("span",{"class":"label label-"+c,html:b}),d.inject(this._tabs[a],"top"))}}}),gx.bootstrap.PopupMeta=new function(){this.zindex=100,this.popups=[],this.register=function(a){return this.popups.push(a),this.zindex=this.zindex+2,this.zindex},this.unregister=function(a){return this.popups.erase(a),this.popups.length},window.addEvent("domready",function(){$(document.body).addEvent("keyup",function(a){if("esc"==a.key){var b=this.popups.getLast();null!=b&&b.options.closable&&b.hide()}}.bind(this))}.bind(this))},gx.bootstrap.Popup=new Class({gx:"gx.bootstrap.Popup",Extends:gx.core.Settings,options:{color:"#000",freezeColor:"#000",opacity:"0.40",position:"fixed",transition:"quad:in",duration:"300",loader:!1,open:!1,content:null,x:"center",y:"center",closable:!0,borderbox:!0,maxHeight:"auto",minHeight:"auto",clickable:!1,destroyOnHide:!1},isOpen:!1,initialize:function(a){try{if(this.parent(a),this.build(),this.options.destroyOnHide===!0){var b=this;this.addEvent("hide",function(){(function(){b.destroy(),b=null}).delay(150)})}}catch(c){gx.util.Console("gx.bootstrap.Popup->initialize: ",c.message)}},build:function(){var a=this;try{this._display={domBody:$(document.body),backdrop:new Element("div",{"class":"modal-backdrop fade"}),modal:new Element("div",{"class":"modal fade"}),dialog:new Element("div",{"class":"modal-dialog"}),content:new Element("div",{"class":"modal-content"}),header:new Element("div",{"class":"modal-header"}),footer:new Element("div",{"class":"modal-footer"}),body:new Element("div",{"class":"modal-body"}),cross:new Element("button",{"class":"close",html:"&times;"}),title:new Element("h4",{"class":"modal-title",html:this.options.title})},this._display.domBody.adopt(this._display.modal),this._display.modal.adopt(this._display.dialog),this._display.dialog.adopt(this._display.content),this._display.content.adopt([this._display.header,this._display.body,this._display.footer]),this._display.header.adopt([this._display.cross,this._display.title]),this.options.width&&this._display.dialog.setStyle("width",this.options.width),this.options.content&&this._display.body.adopt(__(this.options.content)),"array"==typeOf(this.options.footer)?this._display.footer.adopt(this.options.footer):this.options.footer?this._display.footer.adopt(__(this.options.footer)):this._display.footer.destroy(),this.setTitle(this.options.title),this.options.closable?(this._display.cross.addEvent("click",function(){a.hide()}),this.options.clickable&&this._display.backdrop.addEvent("click",function(){a.hide()})):this._display.cross.destroy(),this.options.type&&this._display.header.addClass("text-"+this.options.type)}catch(b){gx.util.Console("gx.bootstrap.Popup->build",b.message)}},setTitle:function(a){return a?(this._display.header.erase("style"),void this._display.title.set("html",a)):void this._display.header.setStyle("display","none")},setContent:function(a){try{switch(this._display.body.empty(),typeOf(a)){case"element":case"elements":case"textnode":case"array":this._display.body.adopt(a);break;case"object":this._display.body.adopt(__(a));break;case"string":case"number":this._display.body.set("html",a)}}catch(b){gx.util.Console("gx.bootstrap.Popup->initialize",b.message)}},getContent:function(){return this._display.body},show:function(a){var b=this;try{var c=gx.bootstrap.PopupMeta.register(this);this._display.modal.setStyle("z-index",c),this._display.backdrop.setStyle("z-index",c-1),this._display.domBody.adopt(this._display.backdrop),this._display.modal.setStyle("display","block"),function(){b._display.backdrop.addClass("in"),b._display.modal.addClass("in"),b._display.domBody.addClass("modal-open")}.delay(100),this.isOpen=!0,this.fireEvent("open")}catch(d){gx.util.Console("gx.bootstrap.Popup->show: ",d.message)}},hide:function(){var a=this;try{this._display.backdrop.removeClass("in"),this._display.modal.removeClass("in"),function(){a._display.modal.setStyle("display","none"),a._display.backdrop.dispose(),0==gx.bootstrap.PopupMeta.unregister(a)&&a._display.domBody.removeClass("modal-open")}.delay(100),this.isOpen=!1,this.fireEvent("hide")}catch(b){gx.util.Console("gx.bootstrap.Popup->hide: ",b.message)}},destroy:function(){this._display.modal.destroy(),this._display.backdrop.destroy(),delete this._display,this.parent()}}),gx.bootstrap.PopupAlert=function(a,b,c){"string"==typeof c&&(c={type:c}),c=Object.merge({title:a,content:b,width:400,destroyOnHide:!0},c||{});var d=new Element("button",{html:"Ok","class":"btn btn-primary"});c.footer=d;var e=new gx.bootstrap.Popup(c);return e.show(),new Promise(function(a,b){d.addEvent("click",function(){("function"!=typeof c.onOk||c.onOk()!==!1)&&(e.hide(),a())}),d.focus()})},gx.bootstrap.PopupConfirmCanceled={},gx.bootstrap.PopupConfirm=function(a,b,c){"string"==typeof c&&(c={type:c}),c=Object.merge({title:a,content:b,width:400,destroyOnHide:!0,modal:!0,onOk:!1},c||{});var d=new Element("button",{html:"Ok","class":"btn btn-primary"}),e=new Element("button",{html:"Cancel","class":"btn btn-default"});c.footer=[e,d];var f=new gx.bootstrap.Popup(c);return f.show(),new Promise(function(a,b){e.addEvent("click",function(){f.hide(),a(gx.bootstrap.PopupConfirmCanceled)}),d.addEvent("click",function(){("function"!=typeof c.onOk||c.onOk()!==!1)&&(f.hide(),a())}),document&&document.activeElement&&"function"==typeof document.activeElement.blur&&document.activeElement.blur()})},gx.bootstrap.Select=new Class({gx:"gx.bootstrap.Select",Extends:gx.ui.Container,options:{height:"auto",allowEmpty:!1,selectionLabel:!1,icon:"chevron-down",resetable:!1,textboxClass:!1,data:null,elementIndex:"ID",elementLabel:"name",elementSelect:"name",elementDefault:null,value:null,msg:{noSelection:"No Selection"}},_closed:!0,_selected:null,_currentElem:null,_running:!1,initialize:function(a,b){var c=this;try{this.parent(a,b),this._display.root.addClass("gx-bootstrap-select"),this._display.textbox=new Element("input",{type:"text","class":"form-control",placeholder:"("+this.getMessage("noSelection")+")"}),this.options.textboxClass&&this._display.textbox.addClass(this.options.textboxClass),this._display.dropdown=new Element("ul",{"class":"dropdown-menu",styles:{"max-height":this.options.height}}),this._display.icon=new Element("span",{"class":"glyphicon glyphicon-"+this.options.icon}),this._display.root.adopt([this._display.icon,this._display.textbox,this._display.dropdown]),this.fxScoll=new Fx.Scroll(this._display.dropdown,{offset:{y:-100}}),this._display.textbox.addEvents({click:function(){this.show()}.bind(this),focus:function(){this.show()}.bind(this),blur:function(){this.hide.delay(300,c)}.bind(this),keypress:function(a){return"tab"!=a.key?"up"==a.key||"down"==a.key?void a.preventDefault():void(null==this.search&&a.preventDefault()):void 0}.bind(this),keydown:function(a){return"tab"!=a.key?"up"==a.key||"down"==a.key?void a.preventDefault():void(null==this.search&&a.preventDefault()):void 0}.bind(this),keyup:function(a){if("tab"!=a.key){if("esc"==a.key)this.hide();else{if("up"==a.key||"down"==a.key){a.preventDefault();var b;return null==this._currentElem?b="down"==a.key?this._display.dropdown.getFirst(":not(.hidden)"):this._display.dropdown.getLast(":not(.hidden)"):"down"==a.key?(b=this._currentElem.getNext(":not(.hidden)"),null==b&&this._currentElem==this._display.dropdown.getLast(":not(.hidden)")&&(b=this._display.dropdown.getFirst(":not(.hidden)"))):(b=this._currentElem.getPrevious(":not(.hidden)"),null==b&&this._currentElem==this._display.dropdown.getFirst(":not(.hidden)")&&(b=this._display.dropdown.getLast(":not(.hidden)"))),void(null!=b&&(null!=this._currentElem&&this._currentElem.removeClass("selected"),this._currentElem=b,this._currentElem.addClass("selected"),this.fxScoll.toElement(this._currentElem)))}if("enter"==a.key){if(null!=this._currentElem){var c=this._currentElem.getElement("a");null!=c&&c.fireEvent("click")}return}}null!=this.search?this.search():a.preventDefault()}}.bind(this)}),gx.util.isFunction(this.options.elementIndex)&&(this.getId=this.options.elementIndex.bind(this)),gx.util.isFunction(this.options.elementLabel)&&(this.getLink=this.options.elementLabel.bind(this)),gx.util.isFunction(this.options.elementSelect)&&(this.showSelection=this.options.elementSelect.bind(this)),gx.util.isArray(this.options.data)&&this.setData(this.options.data),null!=this.options.value&&gx.util.isString(this.options.elementIndex)&&this.options.data.each(function(a){a[this.options.elementIndex]==this.options.value&&this.set(a,!0)}.bind(this))}catch(d){throw d.message="gx.bootstrap.Select->initialize: "+d.message,d}},set:function(a,b){return this._selected=a,this.value=this.getId(),this.update(0!=b)},update:function(a){return null!=a&&a||this.fireEvent(null==this._selected?"noselect":"select",this._selected),this.showSelection(this._selected),this.hide(),this},showSelection:function(){this._display.textbox.set("value",this.getSelectionDisplayValue())},getSelectionDisplayValue:function(){return null==this._selected?"":this._selected[this.options.elementSelect]},getId:function(a){return null!=a?a[this.options.elementIndex]:null!=this._selected?this._selected[this.options.elementIndex]:null},getLink:function(a){return new Element("a",{html:a[this.options.elementLabel]})},setData:function(a){var b=this;try{this._display.dropdown.empty(),this._currentElem=null,this.options.resetable&&this._display.dropdown.adopt(__({tag:"li",child:{tag:"a","class":"reset",html:this.options.resetable,onClick:function(){this.set()}.bind(this)}}));var c=function(a,c){a.addEvent("click",function(){b.set(c)})};null!=this.options.elementDefault&&(a=[this.options.elementDefault].append(a));var d=a.length;for(i=0;i<d;i++)if(null!=a[i]){var e=new Element("li"),f=this.getLink(a[i]);e.store("data",a[i]),e.store("key",i),this._display.dropdown.adopt(e.adopt(f)),c(f,a[i])}}catch(g){throw g.message="gx.bootstrap.Select->setData: "+g.message,g}return this},show:function(){return this._display.textbox.disabled?this:(this._display.root.addClass("open"),this._display.textbox.focus(),this.fireEvent("show"),this)},hide:function(){return this.isOpen()?(this._display.root.removeClass("open"),this.clearCursor(),this.fireEvent("hide"),this.update()):this},isOpen:function(){return this._display.root.hasClass("open")},getValue:function(){return this.getId()},getSelected:function(){return this._selected},clearCursor:function(){null!=this._currentElem&&(this._currentElem.removeClass("selected"),this._currentElem=null)},reset:function(a){return this.set(null,a)},enable:function(){return this._display.textbox.erase("disabled"),this},disable:function(){return this._display.textbox.set("disabled",!0),this},toElement:function(){return this._display.root}}),gx.bootstrap.SelectPrio=new Class({gx:"gx.bootstrap.SelectPrio",Extends:gx.bootstrap.Select,options:{elementIndex:"value",data:[{value:0,color:"#008000",symbol:"■□□□□",label:"lowest"},{value:1,color:"#ffc000",symbol:"■■□□□",label:"low"},{value:2,color:"#ff8000",symbol:"■■■□□",label:"medium"},{value:3,color:"#ff4000",symbol:"■■■■□",label:"high"},{value:4,color:"#c00000",symbol:"■■■■■",label:"highest"}],msg:{lowest:"Lowest",low:"Low",medium:"Medium",high:"High",highest:"Highest"},value:0},showSelection:function(){this._display.textbox.set("value",null==this._selected?"":this._selected.symbol+" | "+this.getMessage(this._selected.label))},getLink:function(a){return new Element("a",{html:a.symbol+" | "+this.getMessage(a.label),styles:{color:a.color}})}}),gx.bootstrap.SelectFilter=new Class({gx:"gx.bootstrap.SelectFilter",Extends:gx.bootstrap.Select,options:{height:"200px",searchfields:["name"]},_lastSearch:null,initialize:function(a,b){try{this.addEvent("show",function(){this._display.textbox.set("value",this._lastSearch),this.search()}.bind(this)),this.addEvent("hide",function(){this._display.textbox.erase("value")}.bind(this)),this.parent(a,b)}catch(c){throw c.message="gx.bootstrap.SelectFilter->initialize: "+c.message,c}},search:function(){try{var a=this._display.textbox.get("value");if(this._lastSearch==a)return;var b=this.getSelectionDisplayValue();if(this._selected&&a==b)return;this.clearCursor(),this._lastSearch=a,this._searchQuery(a)}catch(c){throw c.message="gx.bootstrap.SelectFilter->search: "+c.message,c}},_searchQuery:function(a){try{this._display.dropdown.getElements("li").each(function(b){var c=b.retrieve("data",{});this.options.searchfields.each(function(d){if(""==a)return void b.removeClass("hidden");switch(typeOf(c[d])){case"number":c[d]=c[d].toString();case"string":if(c[d].test(a,"i"))return void b.removeClass("hidden")}b.addClass("hidden")}.bind(this))}.bind(this))}catch(b){throw b.message="gx.bootstrap.SelectFilter->_searchQuery: "+b.message,b}},showLoader:function(){return this._display.icon.set("class","glyphicon glyphicon-refresh"),this},hideLoader:function(){this._display.icon.set("class","glyphicon glyphicon-"+this.options.icon)}}),gx.bootstrap.SelectDyn=new Class({gx:"gx.bootstrap.SelectDyn",Extends:gx.bootstrap.SelectFilter,options:{url:"./",method:"GET",queryParam:"query",parseDefault:!1,requestData:{},requestHeader:{}},_requestChain:[],_firstLoad:!1,initialize:function(a,b){try{null==b.onRequestSuccess&&(this.options.parseDefault=!0),this.addEvent("show",function(){this._firstLoad||(this.search(),this._firstLoad=!0)}.bind(this)),this.parent(a,b),gx.util.isFunction(this.options.queryParam)&&(this.getRequetData=this.options.queryParam.bind(this)),this.options.parseDefault&&this.addEvent("requestSuccess",function(a){var b=gx.util.parseResult(a);this.setData(gx.util.isArray(b)?b:[])}.bind(this))}catch(c){throw c.message="gx.bootstrap.SelectDyn->initialize: "+c.message,c}},getRequetData:function(a,b){return b[this.options.queryParam]=a,b},_searchQuery:function(a){var b=new Request({method:this.options.method,url:this.options.url,data:this.getRequetData(a,Object.clone(this.options.requestData)),header:this.options.requestHeader,onRequest:function(){this.showLoader()}.bind(this),onComplete:function(){this.hideLoader();var a=this._requestChain.pop();null!=a&&a!=b&&(this._requestChain=[],a.send())}.bind(this),onSuccess:function(a){this.fireEvent("requestSuccess",a)}.bind(this),onFailure:function(){this.fireEvent("requestFailure")}.bind(this)});this._requestChain.push(b),1==this._requestChain.length&&b.send()}}),gx.bootstrap.SelectDynREST=new Class({gx:"gx.bootstrap.SelectDyn",Extends:gx.bootstrap.SelectFilter,options:{entity:"",requestData:{},limit:50},_requestChain:[],_firstLoad:!1,data:null,initialize:function(a,b){null==b.onRequestSuccess&&(this.options.parseDefault=!0),this.addEvent("show",function(){this._firstLoad||(this.search(),this._firstLoad=!0)}.bind(this)),this.parent(a,b)},_searchQuery:function(a){this.showLoader(),gx.zeyosREST.Factory.getRESTmodel().listQuery(this.options.entity).limit(this.options.limit).search(a).run().then(function(a){this.hideLoader(),this.data=a.result,this.setData(a.result)}.bind(this))["catch"](function(a){throw this.hideLoader(),a}.bind(this))},setEntityId:function(a){var b;return this.data&&(b=this.data.findBy("ID",a)),b?(this.set(b),Promise.resolve()):a?(this.showLoader(),gx.zeyosREST.Factory.getRESTmodel().itemQuery(this.options.entity,a).run().then(function(a){this.hideLoader(),a&&typeOf(a.result)&&this.set(a.result)}.bind(this))["catch"](function(a){throw this.hideLoader(),a}.bind(this))):Promise.resolve()}}),gx.bootstrap.Tabbox=new Class({gx:"gx.bootstrap.Tabbox",Extends:gx.ui.Tabbox,options:{frames:[],height:!1,show:1,onChange:!1},_tabs:{},build:function(){try{this._display.root.addClass("tabbable"),this._display=Object.merge({},this._display,{tablist:new Element("ul",{"class":"nav nav-tabs"}),content:new Element("div",{"class":"tab-content",styles:{overflow:"auto"}})}),this.options.height&&this._display.content.setStyle("height",this.options.height),this._display.root.adopt(this._display.tablist),this._display.root.adopt(this._display.content)}catch(a){gx.util.Console("gx.bootstrap.Tabbox->build",a.message)}},buildTab:function(a,b){var c=this,d=new Element("a",{html:b.replace(/ /g,"&nbsp;")}),e=new Element("li");return e.adopt(d),this._display.tablist.adopt(e),d.addEvent("click",function(){c.openTab(a)}),this._tabs[a]=e,e},buildContent:function(a){var b=new Element("div",{"class":"tab-pane"}).adopt(a);return this._display.content.adopt(b),b},setHighlight:function(a,b,c){if(null!=this._tabs[a]){var d=this._tabs[a].getElement("span");null!=d&&d.destroy(),null==c&&(c="important"),null!=b&&(d=new Element("span",{"class":"label label-"+c,html:b}),d.inject(this._tabs[a],"top"))}}}),gx.bootstrap.Table=new Class({gx:"gx.bootstrap.Table",Extends:gx.ui.Table,_theme:{filterAsc:"asc",filterDesc:"desc",unfiltered:"",th:"th",filter:"filter",filterElem:"span",mainTable:"fixed table table-striped table-hover",mainThead:"fullw table-head",mainTheadRow:"",mainTbody:"",wrapper:"",emptyCol:"",headerTable:"",tbodyTr:"",oddRow:!1,colCheck:"table-col-check"}}),gx.bootstrap.Timebox=new Class({gx:"gx.bootstrap.Timebox",Extends:gx.ui.Timebox,options:{time:0,unit:"seconds",seconds:!0,prefix:!1,readonly:!1,disabled:!1,orientation:"left",icon:!1,label:""},build:function(){var a=this;try{if(this._display.root.addClass("bs-timebox"),this._display.root.addClass("input-append"),this.options.label||this.options.icon){this._display.root.addClass("input-prepend");var b=this.options.icon?'<i class="icon-'+this.options.icon+'"></i>':"";if(this._display.label=new Element("span"),this.options.label&&"object"==typeof this.options.label){var c=Object.clone(this.options.label);null==c.html?String(c.text).htmlSpecialChars():c.html;c.html=b+(c.text?" "+c.text:""),delete c.text,this._display.label.set(c)}else this._display.label.set("html",b+(this.options.label?" "+this.options.label:""));this._display.label.addClass("add-on"),this._display.root.adopt(this._display.label)}this._display.hours=new Element("input",{type:"text"}),this._display.root.adopt(this._display.hours),this._display.hours.addEvent("change",function(){a.update()}),this._display.minutes=new Element("input",{type:"text",styles:{"border-radius":0}}),this._display.root.adopt(new Element("span",{"class":"separator",html:":"})),this._display.root.adopt(this._display.minutes),this._display.minutes.addEvent("change",function(){a.update()});var d=this.options.readonly&&!gx.ui.Timebox.legacyMode,e=this.options.disabled||gx.ui.Timebox.legacyMode&&this.options.readonly;this.options.seconds&&(this._display.seconds=new Element("input",{type:"text",styles:{"border-radius":0}}),this._display.root.adopt(new Element("span",{"class":"separator",html:":"})),this._display.root.adopt(this._display.seconds),this._display.seconds.addEvent("change",function(){a.update()}),d&&this._display.seconds.set("readonly","readonly"),e&&this._display.seconds.set("disabled","disabled")),d&&(this._display.hours.set("readonly","readonly"),this._display.minutes.set("readonly","readonly")),e&&this.disable(),this.options.prefix&&(this._display.prefix=new Element("button",{"class":"btn btn-success",html:'&nbsp;<i class="icon-plus"></i>'}),this._display.root.adopt(this._display.prefix),this._display.prefix.addEvent("click",function(){a.options.disabled||gx.ui.Timebox.legacyMode&&a.options.readonly||a.setPrefix(!a._prefix)}))}catch(f){gx.util.Console("gx.bootstrap.Timebox->build",f.message)}},setPrefix:function(a){try{this._display.prefix&&(this._prefix=a,this._prefix?(this._display.prefix.removeClass("btn-danger"),this._display.prefix.addClass("btn-success"),this._display.prefix.set("html",'&nbsp;<i class="icon-plus"></i>')):(this._display.prefix.removeClass("btn-success"),this._display.prefix.addClass("btn-danger"),this._display.prefix.set("html",'&nbsp;<i class="icon-minus"></i>')))}catch(b){gx.util.Console("gx.bootstrap.Timebox->setPrefix",b.message)}return this}}),gx.bootstrap.ValueList=new Class({Extends:gx.ui.Container,options:{deletable:!0},initialized:!1,initialize:function(a,b){var c=this;try{this.parent(a,b),this._display.root.addClass("bs-valuelist"),this.options.deletable&&this._display.root.addClass("bs-valuelist-deletable");var d=new Element("span",{styles:{position:"absolute",left:"-100000px",padding:"10px"}}).inject($(document.body));this._display.textbox=new Element("input",{type:"text"}).addEvents({keydown:function(a){"enter"==a.key&&""!=this.get("value")?(c.addValue(this.get("value")),this.erase("value")):(d.set("html",this.get("value")),this.setStyle("width",d.offsetWidth))},focus:function(){c._display.root.addClass("focus")},blur:function(){c._display.root.removeClass("focus"),""!=this.get("value")&&(c.addValue(this.get("value")),this.erase("value"))}}),this._display.list=new Element("ul"),this._display.root.adopt([this._display.list,this._display.textbox,new Element("div",{"class":"clear"})]),this._display.root.addEvent("click",function(){c._display.textbox.focus()}),this.sortable=new Sortables(this._display.list)}catch(e){gx.util.Console("gx.bootstrap.ValueList->initialize",gx.util.parseError(e))}},focus:function(){this._display.textbox.focus()},addValue:function(a){var b=this,c=new Element("li",{html:a}).addEvent("click",function(){b.fireEvent("click")});c.store("value",a),this.options.deletable&&c.adopt(new Element("span").addEvent("click",function(){c.destroy()})),this._display.list.adopt(c),null!=this.sortable&&this.sortable.addItems(c)},getValues:function(){var a=[];return this._display.list.getElements("li").each(function(b){a.push(b.retrieve("value"))}),a},setValues:function(a){null!=this.sortable&&this.sortable.removeItems(this._display.list.getElements("li")).destroy(),null!=a&&a.each(function(a){this.addValue(a)}.bind(this))},disable:function(){this._display.textbox.setStyle("display","none"),this._display.root.removeClass("bs-valuelist-deletable"),this._display.root.addClass("bs-valuelist-readonly"),delete this.sortable},enable:function(){this._display.textbox.setStyle("display","inline-block"),this._display.root.removeClass("bs-valuelist-readonly"),this.sortable=new Sortables(this._display.list),this.options.deletable&&this._display.root.addClass("bs-valuelist-deletable")}});